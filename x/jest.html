
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <title>Joshua Paling </title>
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
  <link href="../stylesheets/application-650b1803.css" rel="stylesheet" />
  <script src="../javascripts/application-8d565278.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
<body>
  <div class="page-wrapper">
    <header>
      <h1>Joshua Paling</h1>
      <nav>
        <a class="" href="/">Blog</a>
        <a class="" href="/about.html">About</a>
        <a class="" href="/resume.html">Resume</a>
        <a href="../feed.xml">RSS</a>
        <a target="_blank" href="https://twitter.com/joshuapaling">@joshuapaling</a>
      </nav>
    </header>


<h1>Jest</h1>

<p>Example test with mocks</p>

<pre><code class="language-javascript">
const { factory } = require('test/helpers/jest');

//////////////////////////////////
// THE MOCK MUST BE ABOVE ALL OTHER CODE
//////////////////////////////////

jest.mock('./avgKmsByAllocatedStudentsPerYear', () =&gt; {
  return jest.fn().mockReturnValue({
    2015: 4,
    2016: 2,
  });
});

const averageTravelDistanceByYear = require('./averageTravelDistanceByYear');

describe('averageTravelDistanceByYear', () =&gt; {
  it.only(
    'works with data from multiple meshblocks and schools; respects weighting based on allocated_students',
    async function() {
      const scenario = await factory.create('scenario', {
        start_year: 2015,
      });

      const result = await averageTravelDistanceByYear(scenario);
      const expected = {
        2015: (4 * 100 + 10 * 50) / (100 + 50),
        2016: (2 * 150 + 5 * 60) / (150 + 60),
      };
      expect(result[2015]).toBe(expected[2015]);
      expect(result[2016]).toBe(expected[2016]);
    }
  );
});
</code></pre>


    <!-- Footer -->
    <footer>
      <nav>
        <a class="" href="/">Blog</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/about.html">About</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/resume.html">Resume</a>
        &nbsp;&bull;&nbsp;
        <a href="../feed.xml">RSS</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/archives.html">Archives</a>
      </nav>
      <div class="row">
        <div class="col-lg-12">
          <p>Copyright &copy; Joshua Paling 2015</p>
        </div>
      </div>
      <!-- /.row -->
    </footer>

  </div>

</body>
</html>


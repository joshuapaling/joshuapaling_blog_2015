
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <title>Joshua Paling  - How to show latest products in Spree</title>
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
  <link href="../../../../stylesheets/application-4b18c387.css" rel="stylesheet" />
  <script src="../../../../javascripts/application-8d565278.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
<body>
  <div class="page-wrapper">
    <header>
      <h1>Joshua Paling</h1>
      <nav>
        <a class="active" href="/">Blog</a>
        <a class="" href="/about.html">About</a>
        <a class="" href="/resume.html">Resume</a>
        <a href="../../../../feed.xml">RSS</a>
        <a target="_blank" href="https://twitter.com/joshuapaling">@joshuapaling</a>
      </nav>
    </header>


<p>For a spree project I'm working on, I needed a <em>latest products</em> page. Since I'm new to spree/rails, it took me a while, but it's super easy once you know how. Here's how it's done, for any other newbies wanting to display most recent products in spree.</p>

<h2 id="create-a-decorator-for-the-products-controller">Create a Decorator for the Products Controller</h2>

<p>According to the <a href="http://guides.spreecommerce.com/developer/logic.html">Spree Guides</a>, to customise logic, first up, we need to add a <a href="http://kresimirbojcic.com/2011/12/01/decorators-in-ruby.html">decorator</a> for our products controller.</p>

<p>We can add our decorator anywhere inside the <code>app/controllers</code> directory, or a subfolder of it. The preferred place to add it is inside a <code>spree</code> subfolder. So, create <code>products_controller_decorator.rb</code> inside <code>app/controllers/spree/</code>, and add the following code:</p>

<pre><code class="language-ruby">Spree::ProductsController.class_eval do
  def latest
    @products = Spree::Product.available.order('available_on DESC').limit(25);
    render "index"
  end
end
</code></pre>

<p>It's a pretty straight-forward method. We simply select 25 Products, and order them by <code>available_on</code>, descending. We use the <code>available</code> scope, to limit our selection to products which actually are available - so products with a future <code>available_on</code> date will be excluded.</p>

<p>We also specify that we want to render the <code>index</code> view for this page - so our <em>latest products</em> page will look the same as our regular <em>products index</em> page. If you don't want to use the index view, delete the <code>render index</code> line, and create a new view template at <code>app/views/spree/products/latest.html.erb</code>.</p>

<h2 id="add-a-route-for-your-latest-products-page">Add a route for your Latest Products Page</h2>

<p>Last but not least, we need to define a route for our latest products page. As it stands, when we try to access <code>www.example.com/products/latest</code>, spree assumes we're trying to show the product with name/slug of 'latest'.</p>

<p>Open up <code>config/routes.rb</code>, and add the following code up the top, just under the line <code>Www::Application.routes.draw do</code>:</p>

<pre><code class="language-ruby">Spree::Core::Engine.routes.draw do
  match 'products/latest' =&gt; 'products#latest', :as =&gt; :latest
end
</code></pre>

<p>Now, our <strong>latest products</strong> page will be available at <code>www.example.com/products/latest</code>, and we can link to it in our view files with something like this:</p>

<pre><code class="language-markup">&lt;a href="&lt;%= spree.latest_path %&gt;"&gt;Latest Products&lt;/a&gt;
</code></pre>

<p>That's it! We're all done, in just a few simple lines of code. But it would have been just as easy with Magento, right? ;)</p>

<h3 id="add-a-page-for-products-coming-soon">Add a page for products coming soon</h3>

<p>I won't do it here, but it would be similarly easy to add a 'coming soon' pageâ€¦ you'd just have to use the same process as above, but fetch products where the <code>available_on</code> is after today's date.</p>

<h4 id="edit">EDIT:</h4>

<p>Actually, it wouldn't be that simple to add a 'coming soon' page. See comment below from Rebecca Skinner: "Not as straightforward to add a 'coming soon' page - products that have an <code>available_on</code> date in the future are not public. And if you make them public, nothing to stop them being added to carts, and purchased."</p>


    <!-- Footer -->
    <footer>
      <nav>
        <a class="active" href="/">Blog</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/about.html">About</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/resume.html">Resume</a>
        &nbsp;&bull;&nbsp;
        <a href="../../../../feed.xml">RSS</a>
        &nbsp;&bull;&nbsp;
        <a class="" href="/archives.html">Archives</a>
      </nav>
      <div class="row">
        <div class="col-lg-12">
          <p>Copyright &copy; Joshua Paling 2015</p>
        </div>
      </div>
      <!-- /.row -->
    </footer>

  </div>

</body>
</html>

